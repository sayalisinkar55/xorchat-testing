/**
 * 
 */
package pageobjectspkg;

import Constantpkg.loginlocators;

import java.util.HashMap;
import java.util.Map;
import java.util.Set;
import java.util.concurrent.TimeUnit;

import org.openqa.selenium.Alert;
import org.openqa.selenium.By;
import org.openqa.selenium.Keys;
import org.openqa.selenium.WebDriver;
import org.openqa.selenium.WebElement;
import org.openqa.selenium.chrome.ChromeDriver;
import org.openqa.selenium.chrome.ChromeOptions;
import org.openqa.selenium.interactions.Actions;
import org.openqa.selenium.support.ui.ExpectedConditions;
import org.openqa.selenium.support.ui.WebDriverWait;
import org.testng.Reporter;

import com.gargoylesoftware.htmlunit.javascript.host.Iterator;

/**
 * @author Sinkar_S
 *
 */
public class chatBoxLandingPg {
	WebDriver driver;
	/**
	 * Defined the variable to store the Xpath and Ids
	 */
	By username = By.id("userNameInput");
	By password = By.id("passwordInput");
	By signin = By.id("submitButton");
	By icon = By.id("_menuEllipsis");
	By Mousehover = By.xpath(Constantpkg.loginlocators.Mouse_hover);
	By Endbtn = By.xpath(Constantpkg.loginlocators.ENDButton_btn);
	By Clickadd = By.xpath(Constantpkg.loginlocators.Add_user);
	By tapadd = By.xpath(Constantpkg.loginlocators.User_add);
	By entertext = By.xpath(Constantpkg.loginlocators.Enter_TEXT);
	By clickOnSearchUser = By.xpath(Constantpkg.loginlocators.clickOnSerchUser);
	By clickuser = By.xpath(Constantpkg.loginlocators.click_user);
	By txtMsg = By.id(Constantpkg.loginlocators.click_click);
	By NewEndbtn = By.xpath("//*[@id='step-0']/div[3]/button");
	By user1Message = By.xpath(Constantpkg.loginlocators.user1Message);

	public chatBoxLandingPg(WebDriver driver) {
		this.driver = driver;
	}

	/**
	 * 
	 * Method created to enter username and password
	 */
	public void setUsername(String value) {
		WebDriverWait wait = new WebDriverWait(driver, 10);
		wait.until(ExpectedConditions.presenceOfElementLocated(username));
		driver.findElement(username).sendKeys(value);
		// userIDFld.sendKeys(value);
	}

	public void setPassword(String value) {
		WebDriverWait wait = new WebDriverWait(driver, 10);
		wait.until(ExpectedConditions.presenceOfElementLocated(password));
		driver.findElement(password).sendKeys(value);
		// passwordFld.sendKeys(value);

	}

	/**
	 * Method creted for to click on login button
	 */

	public void clickLoginButton() {
		WebDriverWait wait = new WebDriverWait(driver, 10);
		WebElement element = wait.until(ExpectedConditions.elementToBeClickable(signin));
		driver.findElement(signin).click();
		// sloginBtn.click();

	}

	/**
	 * Method creted for the login page
	 */
	public void loginByUsername(String Username, String Password) {
		try{
		setUsername(Username);
		setPassword(Password);
		clickLoginButton();
		Reporter.log("login successful");
		} catch (Exception e) {
			Reporter.log("login failed");		
	}}

	/**
	 * Method creted for to click on the notification block which disply the
	 * tour of the application
	 */
	public void clickEndTourBtn(WebDriver driver) {
		WebDriverWait wait = new WebDriverWait(driver, 10);
		WebElement btnEndTour = wait.until(ExpectedConditions.elementToBeClickable(Endbtn));
		//WebElement h1 = driver.findElement(Endbtn);
		btnEndTour.click();
	}

	/*
	 * public void clickhover() { Actions action = new Actions(driver);
	 * WebElement we = driver.findElement(Mousehover);
	 * action.moveToElement(we).build().perform();
	 * 
	 * }
	 */

	/*
	 * public void addUser() { WebDriverWait wait = new WebDriverWait(driver,
	 * 10); WebElement element=
	 * wait.until(ExpectedConditions.elementToBeClickable(Clickadd));
	 * element.click(); WebElement se = driver.findElement(entertext);
	 * se.click(); }
	 * 
	 * 
	 * public void tapAdd() { WebElement te=driver.findElement(tapadd);
	 * te.click(); } public void searchbutton() { WebElement
	 * qe=driver.findElement(searchbtn); qe.click();
	 * 
	 * }
	 */

	/**
	 * Method to click on the serached user name
	 */
	public void selectUserToChat() {
		WebDriverWait wait = new WebDriverWait(driver, 10);
		WebElement selectUser = wait.until(ExpectedConditions.elementToBeClickable(clickuser));		
		selectUser.click();
		
	    driver.findElement(By.xpath("//*[@id='_userSearch']").sendKeys(user));
		
	}

	/**
	 * Method created to click on the message text area
	 * 
	 */
//	public WebElement click_on_chat_area() {
//		WebDriverWait wait = new WebDriverWait(driver, 20);
//
//		wait.until(ExpectedConditions.presenceOfElementLocated(click_on_chat_area));
//		wait.until(ExpectedConditions.elementToBeClickable(click_on_chat_area));
//		WebElement ee = driver.findElement(click_on_chat_area);
//
//		/*
//		 * ee.sendKeys("Hi"); ee.sendKeys(Keys.ENTER);
//		 */
//		return ee;
//
//	}

	/**
	 * Method to switch the window
	 */
	public void switchToNewWidnow() {

		Set<String> windowHandle = driver.getWindowHandles();
		for (String winHandle : windowHandle) {
			driver.switchTo().window(winHandle);
		}

	}
	
	public void enterMsgInChatBox(String msg){
		WebDriverWait wait = new WebDriverWait(driver, 20);
		//wait.until(ExpectedConditions.presenceOfElementLocated(txtMsg));
		wait.until(ExpectedConditions.elementToBeClickable(txtMsg));
		driver.findElement(txtMsg).sendKeys(msg);
		driver.findElement(txtMsg).sendKeys(Keys.ENTER);
	}
	
	public void validateUserMessage(String msg){
		String userMsg = driver.findElement(user1Message).getText();
		if(userMsg.equalsIgnoreCase(msg))
			Reporter.log("Chat message validated successfully");
		else
			Reporter.log("Chat message mismatch");
	}

}